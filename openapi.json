{"openapi":"3.0.0","info":{"title":"Fixmo Backend API","version":"1.0.0","description":"A comprehensive service management platform that connects customers with service providers","contact":{"name":"Fixmo API Support","email":"support@fixmo.com"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"servers":[{"url":"http://localhost:3000","description":"Development server"},{"url":"https://api.fixmo.com","description":"Production server"}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"JWT token for authentication"}},"schemas":{"User":{"type":"object","properties":{"user_id":{"type":"integer","description":"Unique user identifier"},"first_name":{"type":"string","description":"User first name"},"last_name":{"type":"string","description":"User last name"},"email":{"type":"string","format":"email","description":"User email address"},"phone_number":{"type":"string","description":"User phone number"},"profile_photo":{"type":"string","nullable":true,"description":"Profile photo file path"},"valid_id":{"type":"string","nullable":true,"description":"Valid ID document file path"},"user_location":{"type":"string","nullable":true,"description":"User location"},"created_at":{"type":"string","format":"date-time","description":"Account creation timestamp"},"is_verified":{"type":"boolean","description":"User verification status"},"userName":{"type":"string","description":"Unique username"},"is_activated":{"type":"boolean","description":"Account activation status"},"birthday":{"type":"string","format":"date-time","nullable":true,"description":"User birthday"},"exact_location":{"type":"string","nullable":true,"description":"Exact user location"}}},"ServiceProvider":{"type":"object","properties":{"provider_id":{"type":"integer","description":"Unique provider identifier"},"provider_first_name":{"type":"string","description":"Provider first name"},"provider_last_name":{"type":"string","description":"Provider last name"},"provider_email":{"type":"string","format":"email","description":"Provider email address"},"provider_phone_number":{"type":"string","description":"Provider phone number"},"provider_profile_photo":{"type":"string","nullable":true,"description":"Provider profile photo"},"provider_valid_id":{"type":"string","nullable":true,"description":"Provider valid ID document"},"provider_isVerified":{"type":"boolean","description":"Provider verification status"},"created_at":{"type":"string","format":"date-time","description":"Account creation timestamp"},"provider_rating":{"type":"number","format":"float","description":"Average provider rating"},"provider_location":{"type":"string","nullable":true,"description":"Provider location"},"provider_uli":{"type":"string","description":"Unique provider identifier"},"provider_userName":{"type":"string","description":"Provider username"},"provider_isActivated":{"type":"boolean","description":"Provider activation status"},"provider_birthday":{"type":"string","format":"date-time","nullable":true,"description":"Provider birthday"},"provider_exact_location":{"type":"string","nullable":true,"description":"Exact provider location"}}},"ServiceListing":{"type":"object","properties":{"service_id":{"type":"integer","description":"Unique service identifier"},"service_title":{"type":"string","description":"Service title"},"service_description":{"type":"string","description":"Service description"},"service_startingprice":{"type":"number","format":"float","description":"Starting price for service"},"provider_id":{"type":"integer","description":"Provider who offers this service"},"servicelisting_isActive":{"type":"boolean","description":"Service availability status"},"service_picture":{"type":"string","nullable":true,"description":"Service image file path"}}},"Appointment":{"type":"object","properties":{"appointment_id":{"type":"integer","description":"Unique appointment identifier"},"customer_id":{"type":"integer","description":"Customer who booked the appointment"},"provider_id":{"type":"integer","description":"Service provider for the appointment"},"appointment_status":{"type":"string","enum":["pending","approved","confirmed","in-progress","finished","completed","cancelled","no-show"],"description":"Current appointment status"},"scheduled_date":{"type":"string","format":"date-time","description":"Scheduled appointment date and time"},"repairDescription":{"type":"string","nullable":true,"description":"Description of repair needed"},"created_at":{"type":"string","format":"date-time","description":"Appointment creation timestamp"},"final_price":{"type":"number","format":"float","nullable":true,"description":"Final agreed price"},"availability_id":{"type":"integer","description":"Associated availability slot"},"service_id":{"type":"integer","description":"Service being requested"},"cancellation_reason":{"type":"string","nullable":true,"description":"Reason for cancellation if cancelled"}}},"Rating":{"type":"object","properties":{"id":{"type":"integer","description":"Unique rating identifier"},"rating_value":{"type":"integer","minimum":1,"maximum":5,"description":"Rating value (1-5 stars)"},"rating_comment":{"type":"string","nullable":true,"description":"Optional rating comment"},"rating_photo":{"type":"string","nullable":true,"description":"Optional rating photo file path"},"appointment_id":{"type":"integer","description":"Related appointment"},"user_id":{"type":"integer","description":"User who gave the rating"},"provider_id":{"type":"integer","description":"Provider being rated"},"rated_by":{"type":"string","enum":["customer","provider"],"description":"Who submitted the rating"},"created_at":{"type":"string","format":"date-time","description":"Rating creation timestamp"}}},"Certificate":{"type":"object","properties":{"certificate_id":{"type":"integer","description":"Unique certificate identifier"},"certificate_name":{"type":"string","description":"Certificate name"},"certificate_file_path":{"type":"string","description":"Certificate file path"},"expiry_date":{"type":"string","format":"date-time","nullable":true,"description":"Certificate expiry date"},"provider_id":{"type":"integer","description":"Provider who owns the certificate"},"certificate_number":{"type":"string","description":"Unique certificate number"},"certificate_status":{"type":"string","enum":["Pending","Approved","Rejected"],"description":"Certificate approval status"},"created_at":{"type":"string","format":"date-time","description":"Certificate upload timestamp"}}},"Availability":{"type":"object","properties":{"availability_id":{"type":"integer","description":"Unique availability identifier"},"dayOfWeek":{"type":"string","description":"Day of the week"},"startTime":{"type":"string","description":"Start time (HH:MM format)"},"endTime":{"type":"string","description":"End time (HH:MM format)"},"provider_id":{"type":"integer","description":"Provider setting availability"},"availability_isActive":{"type":"boolean","description":"Availability status"}}},"ErrorResponse":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","description":"Error message"},"error":{"type":"string","description":"Additional error details"}}},"SuccessResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","description":"Success message"},"data":{"type":"object","description":"Response data"}}},"PaginationResponse":{"type":"object","properties":{"current_page":{"type":"integer","description":"Current page number"},"total_pages":{"type":"integer","description":"Total number of pages"},"total_count":{"type":"integer","description":"Total number of items"},"limit":{"type":"integer","description":"Items per page"},"has_next":{"type":"boolean","description":"Whether there is a next page"},"has_prev":{"type":"boolean","description":"Whether there is a previous page"}}}},"examples":{"CustomerLoginRequest":{"summary":"Customer login request","value":{"email":"customer@example.com","password":"password123"}},"CustomerLoginResponse":{"summary":"Successful customer login","value":{"message":"Login successful","token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...","userId":123,"userName":"johndoe"}}}},"tags":[{"name":"Authentication","description":"Customer and Provider authentication endpoints"},{"name":"Services","description":"Service management endpoints"},{"name":"Appointments","description":"Appointment booking and management"},{"name":"Ratings","description":"Rating and review system"},{"name":"Certificates","description":"Certificate management for providers"},{"name":"Availability","description":"Provider availability management"},{"name":"Admin","description":"Administrative functions"},{"name":"System","description":"System health and utility endpoints"}],"paths":{"/api/appointments":{"get":{"tags":["Appointments"],"summary":"Get all appointments with filtering and pagination","description":"Retrieve appointments with advanced filtering options","parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1},"description":"Page number for pagination"},{"in":"query","name":"limit","schema":{"type":"integer","default":10},"description":"Number of items per page"},{"in":"query","name":"status","schema":{"type":"string","enum":["pending","approved","confirmed","in-progress","finished","completed","cancelled","no-show"]},"description":"Filter by appointment status"},{"in":"query","name":"provider_id","schema":{"type":"integer"},"description":"Filter by provider ID"},{"in":"query","name":"customer_id","schema":{"type":"integer"},"description":"Filter by customer ID"},{"in":"query","name":"from_date","schema":{"type":"string","format":"date-time"},"description":"Start date filter (ISO format)"},{"in":"query","name":"to_date","schema":{"type":"string","format":"date-time"},"description":"End date filter (ISO format)"},{"in":"query","name":"sort_by","schema":{"type":"string","default":"scheduled_date"},"description":"Field to sort by"},{"in":"query","name":"sort_order","schema":{"type":"string","enum":["asc","desc"],"default":"desc"},"description":"Sort order"}],"responses":{"200":{"description":"Appointments retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"allOf":[{"$ref":"#/components/schemas/Appointment"},{"type":"object","properties":{"customer":{"type":"object","properties":{"user_id":{"type":"integer"},"first_name":{"type":"string"},"last_name":{"type":"string"},"email":{"type":"string"},"phone_number":{"type":"string"},"user_location":{"type":"string"},"profile_photo":{"type":"string","nullable":true}}},"serviceProvider":{"type":"object","properties":{"provider_id":{"type":"integer"},"provider_first_name":{"type":"string"},"provider_last_name":{"type":"string"},"provider_email":{"type":"string"},"provider_phone_number":{"type":"string"},"provider_location":{"type":"string"},"provider_profile_photo":{"type":"string","nullable":true},"provider_rating":{"type":"number"}}},"appointment_rating":{"type":"array","items":{"$ref":"#/components/schemas/Rating"}}}}]}},"pagination":{"$ref":"#/components/schemas/PaginationResponse"}}}}}}}},"post":{"tags":["Appointments"],"summary":"Create new appointment","description":"Create a new appointment with validation","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["customer_id","provider_id","scheduled_date"],"properties":{"customer_id":{"type":"integer","example":123},"provider_id":{"type":"integer","example":456},"scheduled_date":{"type":"string","format":"date-time","example":"2024-01-15T10:00:00.000Z"},"appointment_status":{"type":"string","enum":["pending","approved","confirmed","in-progress","finished","completed","cancelled","no-show"],"default":"pending"},"final_price":{"type":"number","format":"float","example":150},"repairDescription":{"type":"string","example":"Kitchen sink faucet needs repair"}}}}}},"responses":{"201":{"description":"Appointment created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Appointment created successfully"},"data":{"$ref":"#/components/schemas/Appointment"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/appointments/{appointmentId}":{"get":{"tags":["Appointments"],"summary":"Get appointment by ID","description":"Retrieve a specific appointment with full details","parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"}],"responses":{"200":{"description":"Appointment found","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"$ref":"#/components/schemas/Appointment"}}}}}},"404":{"description":"Appointment not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"put":{"tags":["Appointments"],"summary":"Update appointment","description":"Update appointment details with conflict checking","parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"scheduled_date":{"type":"string","format":"date-time","description":"New scheduled date (checked for conflicts)"},"appointment_status":{"type":"string","enum":["pending","approved","confirmed","in-progress","finished","completed","cancelled","no-show"]},"final_price":{"type":"number","format":"float"},"repairDescription":{"type":"string"}}}}}},"responses":{"200":{"description":"Appointment updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"404":{"description":"Appointment not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"tags":["Appointments"],"summary":"Delete appointment","description":"Permanently delete appointment and related ratings","parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"}],"responses":{"200":{"description":"Appointment deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Appointment deleted successfully"}}}}}}}}},"/api/appointments/{appointmentId}/cancel":{"put":{"tags":["Appointments"],"summary":"Cancel appointment","description":"Cancel appointment with required cancellation reason","parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["cancellation_reason"],"properties":{"cancellation_reason":{"type":"string","example":"Customer emergency - need to reschedule"}}}}}},"responses":{"200":{"description":"Appointment cancelled successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}}}}},"/api/appointments/stats":{"get":{"tags":["Appointments"],"summary":"Get appointment statistics","description":"Get comprehensive appointment statistics with optional filtering","parameters":[{"in":"query","name":"provider_id","schema":{"type":"integer"},"description":"Get stats for specific provider"},{"in":"query","name":"customer_id","schema":{"type":"integer"},"description":"Get stats for specific customer"}],"responses":{"200":{"description":"Statistics retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"total_appointments":{"type":"integer","example":250},"pending_appointments":{"type":"integer","example":15},"confirmed_appointments":{"type":"integer","example":30},"completed_appointments":{"type":"integer","example":180},"cancelled_appointments":{"type":"integer","example":25},"monthly_appointments":{"type":"integer","example":45},"yearly_appointments":{"type":"integer","example":250},"total_revenue":{"type":"number","format":"float","example":25000},"average_rating":{"type":"number","format":"float","example":4.5},"completion_rate":{"type":"number","description":"Completion rate percentage","example":72}}}}}}}}}}},"/api/appointments/provider/{providerId}":{"get":{"tags":["Appointments"],"summary":"Get provider appointments","description":"Get all appointments for a specific provider with filtering","parameters":[{"in":"path","name":"providerId","required":true,"schema":{"type":"integer"},"description":"Provider ID"},{"in":"query","name":"status","schema":{"type":"string"},"description":"Filter by status"},{"in":"query","name":"from_date","schema":{"type":"string","format":"date-time"},"description":"Start date filter"},{"in":"query","name":"to_date","schema":{"type":"string","format":"date-time"},"description":"End date filter"},{"in":"query","name":"page","schema":{"type":"integer","default":1}},{"in":"query","name":"limit","schema":{"type":"integer","default":10}},{"in":"query","name":"sort_order","schema":{"type":"string","enum":["asc","desc"],"default":"desc"}}],"responses":{"200":{"description":"Provider appointments retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"$ref":"#/components/schemas/Appointment"}},"pagination":{"$ref":"#/components/schemas/PaginationResponse"}}}}}}}}},"/api/appointments/customer/{customerId}":{"get":{"tags":["Appointments"],"summary":"Get customer appointments","description":"Get all appointments for a specific customer with filtering","parameters":[{"in":"path","name":"customerId","required":true,"schema":{"type":"integer"},"description":"Customer ID"},{"in":"query","name":"status","schema":{"type":"string"},"description":"Filter by status"},{"in":"query","name":"from_date","schema":{"type":"string","format":"date-time"},"description":"Start date filter"},{"in":"query","name":"to_date","schema":{"type":"string","format":"date-time"},"description":"End date filter"},{"in":"query","name":"page","schema":{"type":"integer","default":1}},{"in":"query","name":"limit","schema":{"type":"integer","default":10}},{"in":"query","name":"sort_order","schema":{"type":"string","enum":["asc","desc"],"default":"desc"}}],"responses":{"200":{"description":"Customer appointments retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"$ref":"#/components/schemas/Appointment"}},"pagination":{"$ref":"#/components/schemas/PaginationResponse"}}}}}}}}},"/auth/login":{"post":{"tags":["Authentication"],"summary":"Customer login","description":"Authenticate customer and receive JWT token","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","example":"customer@example.com"},"password":{"type":"string","example":"password123"}}}}}},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Login successful"},"token":{"type":"string","description":"JWT token (expires in 1 hour)"},"userId":{"type":"integer","example":123},"userName":{"type":"string","example":"johndoe"}}}}}},"400":{"description":"Invalid credentials or missing fields","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Invalid email or password"}}}}}},"500":{"description":"Server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/auth/request-otp":{"post":{"tags":["Authentication"],"summary":"Request OTP for customer registration","description":"Send OTP to email for customer registration (validates email uniqueness)","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email","example":"newcustomer@example.com"}}}}}},"responses":{"200":{"description":"OTP sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"OTP sent to email"}}}}}},"400":{"description":"User already exists","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"User already exists"}}}}}},"429":{"description":"Rate limit exceeded","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Too many OTP requests. Please wait before trying again."}}}}}}}}},"/auth/verify-register":{"post":{"tags":["Authentication"],"summary":"Complete customer registration","description":"Verify OTP and complete customer registration with optional file uploads","requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["first_name","last_name","userName","email","password","phone_number","otp"],"properties":{"first_name":{"type":"string","example":"John"},"last_name":{"type":"string","example":"Doe"},"userName":{"type":"string","example":"johndoe123"},"email":{"type":"string","format":"email","example":"john@example.com"},"password":{"type":"string","example":"securepassword123"},"phone_number":{"type":"string","example":1234567890},"user_location":{"type":"string","example":"New York, NY"},"exact_location":{"type":"string","example":"123 Main St, New York, NY 10001"},"birthday":{"type":"string","format":"date","example":"1990-01-15"},"otp":{"type":"string","example":"123456"},"profile_photo":{"type":"string","format":"binary","description":"Profile photo (JPG, PNG, GIF - max 5MB)"},"valid_id":{"type":"string","format":"binary","description":"Valid ID document (JPG, PNG, PDF - max 5MB)"}}}}}},"responses":{"201":{"description":"User registered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"User registered successfully"},"userId":{"type":"integer","example":123},"profile_photo":{"type":"string","nullable":true,"example":"uploads/customer-profiles/profile_photo-1234567890.jpg"},"valid_id":{"type":"string","nullable":true,"example":"uploads/customer-ids/valid_id-1234567890.jpg"}}}}}},"400":{"description":"Validation error or user already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/auth/provider-login":{"post":{"tags":["Authentication"],"summary":"Service provider login","description":"Authenticate service provider and receive JWT token","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["provider_email","provider_password"],"properties":{"provider_email":{"type":"string","format":"email","example":"provider@example.com"},"provider_password":{"type":"string","example":"password123"}}}}}},"responses":{"200":{"description":"Provider login successful","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Login successful"},"token":{"type":"string","description":"JWT token"},"providerId":{"type":"integer","example":456},"providerUserName":{"type":"string","example":"johnprovider"}}}}}}}}},"/auth/provider-request-otp":{"post":{"tags":["Authentication"],"summary":"Request OTP for provider registration","description":"Send OTP to provider email for registration","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["provider_email"],"properties":{"provider_email":{"type":"string","format":"email","example":"newprovider@example.com"}}}}}},"responses":{"200":{"description":"OTP sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"OTP sent to provider email"}}}}}}}}},"/auth/provider-verify-register":{"post":{"tags":["Authentication"],"summary":"Complete provider registration","description":"Verify OTP and complete provider registration with optional file uploads","requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["provider_first_name","provider_last_name","provider_email","provider_phone_number","provider_location","provider_uli","provider_userName","provider_password","otp"],"properties":{"provider_first_name":{"type":"string","example":"Jane"},"provider_last_name":{"type":"string","example":"Smith"},"provider_email":{"type":"string","format":"email","example":"jane@servicecompany.com"},"provider_phone_number":{"type":"string","example":1234567890},"provider_location":{"type":"string","example":"Los Angeles, CA"},"provider_uli":{"type":"string","example":"ULI123456789","description":"Unique provider identifier"},"provider_userName":{"type":"string","example":"janesmith_plumber"},"provider_password":{"type":"string","example":"securepassword123"},"provider_birthday":{"type":"string","format":"date","example":"1985-05-20"},"provider_exact_location":{"type":"string","example":"456 Service Ave, Los Angeles, CA 90001"},"otp":{"type":"string","example":"654321"},"provider_profile_photo":{"type":"string","format":"binary","description":"Provider profile photo"},"provider_valid_id":{"type":"string","format":"binary","description":"Provider valid ID document"},"certificateNames":{"type":"array","items":{"type":"string"},"example":["Plumbing License","Electrical Certification"]},"certificateNumbers":{"type":"array","items":{"type":"string"},"example":["PL123456","EC789012"]},"expiryDates":{"type":"array","items":{"type":"string","format":"date"},"example":["2025-12-31","2024-06-30"]}}}}}},"responses":{"201":{"description":"Provider registered successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}}}}},"/api/availability":{"get":{"tags":["Availability"],"summary":"Get provider availability","description":"Get availability schedule for a provider","parameters":[{"in":"query","name":"provider_id","required":true,"schema":{"type":"integer"},"description":"Provider ID"},{"in":"query","name":"day","schema":{"type":"string"},"description":"Specific day of week (optional)"}],"responses":{"200":{"description":"Provider availability retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Availability"}}}}}}},"post":{"tags":["Availability"],"summary":"Set provider availability","description":"Create a new availability slot for a provider","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["provider_id","dayOfWeek","startTime","endTime"],"properties":{"provider_id":{"type":"integer","example":456,"description":"Provider ID"},"dayOfWeek":{"type":"string","example":"Monday","description":"Day of the week"},"startTime":{"type":"string","example":"09:00","description":"Start time in HH:MM format"},"endTime":{"type":"string","example":"17:00","description":"End time in HH:MM format"},"availability_isActive":{"type":"boolean","default":true,"description":"Whether this availability slot is active"}}}}}},"responses":{"201":{"description":"Availability created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/availability/{availabilityId}":{"delete":{"tags":["Availability"],"summary":"Delete availability","description":"Delete an availability slot","parameters":[{"in":"path","name":"availabilityId","required":true,"schema":{"type":"integer"},"description":"Availability ID"}],"responses":{"200":{"description":"Availability deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Availability slot deleted successfully"}}}}}},"404":{"description":"Availability not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/availability/summary":{"get":{"tags":["Availability"],"summary":"Get availability summary","description":"Get a summary of provider availability","parameters":[{"in":"query","name":"provider_id","required":true,"schema":{"type":"integer"},"description":"Provider ID"}],"responses":{"200":{"description":"Availability summary retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"provider_id":{"type":"integer","example":456},"total_slots":{"type":"integer","example":14},"active_slots":{"type":"integer","example":12},"weekly_schedule":{"type":"array","items":{"type":"object","properties":{"day":{"type":"string","example":"Monday"},"slots":{"type":"array","items":{"type":"object","properties":{"startTime":{"type":"string","example":"09:00"},"endTime":{"type":"string","example":"17:00"},"isActive":{"type":"boolean","example":true}}}}}}}}}}}}}}}}},"/api/certificates":{"get":{"tags":["Certificates"],"summary":"Get provider certificates","description":"Get all certificates for the authenticated provider","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Provider certificates retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Certificate"}}}}},"401":{"description":"Unauthorized - Provider authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/certificates/valid-types":{"get":{"tags":["Certificates"],"summary":"Get valid certificate types","description":"Get list of valid certificate types for providers","responses":{"200":{"description":"Valid certificate types retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"},"example":["Electrical Certificate","Plumbing License","HVAC Certification","General Contractor License","Carpentry Certificate","Painting License","Appliance Repair Certificate"]}}}}}}},"/api/certificates/upload":{"post":{"tags":["Certificates"],"summary":"Upload certificate","description":"Upload a new certificate for provider verification","requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["certificate_name","certificate_number","provider_id","certificateFile"],"properties":{"certificate_name":{"type":"string","example":"Plumbing License","description":"Name of the certificate"},"certificate_number":{"type":"string","example":"PL123456789","description":"Unique certificate number"},"provider_id":{"type":"integer","example":456,"description":"Provider ID"},"expiry_date":{"type":"string","format":"date","example":"2025-12-31","description":"Certificate expiry date (optional)"},"certificateFile":{"type":"string","format":"binary","description":"Certificate file (PDF, JPG, PNG, DOC, DOCX - max 10MB)"}}}}}},"responses":{"201":{"description":"Certificate uploaded successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Certificate uploaded successfully"},"data":{"$ref":"#/components/schemas/Certificate"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","examples":{"missing_fields":{"value":"Certificate name, number, and file are required"},"duplicate_number":{"value":"Certificate number already exists"},"invalid_file":{"value":"Invalid file type. Please upload PDF, image, or document files only"}}}}}}}},"422":{"description":"File upload error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/certificates/{certificateId}":{"get":{"tags":["Certificates"],"summary":"Get certificate by ID","description":"Get a specific certificate by its ID","parameters":[{"in":"path","name":"certificateId","required":true,"schema":{"type":"integer"},"description":"Certificate ID"}],"responses":{"200":{"description":"Certificate retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"$ref":"#/components/schemas/Certificate"}}}}}},"404":{"description":"Certificate not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"tags":["Certificates"],"summary":"Delete certificate","description":"Delete a certificate (removes file and database record)","parameters":[{"in":"path","name":"certificateId","required":true,"schema":{"type":"integer"},"description":"Certificate ID"}],"responses":{"200":{"description":"Certificate deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Certificate deleted successfully"}}}}}},"404":{"description":"Certificate not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Error deleting certificate file","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/ratings/rateable-appointments":{"get":{"tags":["Ratings"],"summary":"Get rateable appointments","description":"Get completed appointments that the authenticated customer can rate","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Rateable appointments retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"$ref":"#/components/schemas/Appointment"}}}}}}},"401":{"description":"Unauthorized - Customer authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/ratings/create":{"post":{"tags":["Ratings"],"summary":"Create rating","description":"Create a new rating for a completed appointment (Customer rates provider)","security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["appointment_id","provider_id","rating_value"],"properties":{"appointment_id":{"type":"integer","example":123,"description":"ID of the completed appointment"},"provider_id":{"type":"integer","example":456,"description":"ID of the provider being rated"},"rating_value":{"type":"integer","minimum":1,"maximum":5,"example":4,"description":"Rating value (1-5 stars)"},"rating_comment":{"type":"string","example":"Great service! Very professional and timely.","description":"Optional comment about the service"},"rating_photo":{"type":"string","format":"binary","description":"Optional photo as proof of completed work (JPG, PNG, GIF)"}}}}}},"responses":{"201":{"description":"Rating created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Rating submitted successfully"},"data":{"allOf":[{"$ref":"#/components/schemas/Rating"},{"type":"object","properties":{"user":{"type":"object","properties":{"user_id":{"type":"integer"},"first_name":{"type":"string"},"last_name":{"type":"string"},"profile_photo":{"type":"string","nullable":true}}},"serviceProvider":{"type":"object","properties":{"provider_id":{"type":"integer"},"provider_first_name":{"type":"string"},"provider_last_name":{"type":"string"}}}}}]}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","examples":{"missing_fields":{"value":"Appointment ID, Provider ID, and rating value are required"},"invalid_rating":{"value":"Rating value must be between 1 and 5"},"already_rated":{"value":"You have already rated this appointment"}}}}}}}},"404":{"description":"Appointment not found or not authorized","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","example":"Appointment not found or not completed, or you are not authorized to rate this appointment"}}}}}}}}},"/api/ratings/update/{ratingId}":{"put":{"tags":["Ratings"],"summary":"Update rating","description":"Update an existing rating (only by the customer who created it)","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"ratingId","required":true,"schema":{"type":"integer"},"description":"Rating ID to update"}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"rating_value":{"type":"integer","minimum":1,"maximum":5,"example":5,"description":"New rating value (1-5 stars)"},"rating_comment":{"type":"string","example":"Updated comment - even better than expected!","description":"Updated comment"},"rating_photo":{"type":"string","format":"binary","description":"New photo (replaces existing photo if any)"}}}}}},"responses":{"200":{"description":"Rating updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"404":{"description":"Rating not found or not authorized","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","example":"Rating not found or you are not authorized to update this rating"}}}}}}}}},"/api/ratings/delete/{ratingId}":{"delete":{"tags":["Ratings"],"summary":"Delete rating","description":"Delete a rating (only by the customer who created it)","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"ratingId","required":true,"schema":{"type":"integer"},"description":"Rating ID to delete"}],"responses":{"200":{"description":"Rating deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Rating deleted successfully"}}}}}},"404":{"description":"Rating not found or not authorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/ratings/customer/{customerId}":{"get":{"tags":["Ratings"],"summary":"Get customer ratings","description":"Get all ratings submitted by a specific customer","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"customerId","required":true,"schema":{"type":"integer"},"description":"Customer ID"}],"responses":{"200":{"description":"Customer ratings retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"$ref":"#/components/schemas/Rating"}}}}}}}}}},"/api/ratings/provider/{providerId}":{"get":{"tags":["Ratings"],"summary":"Get provider ratings (Public)","description":"Get all ratings for a specific provider (public endpoint)","parameters":[{"in":"path","name":"providerId","required":true,"schema":{"type":"integer"},"description":"Provider ID"}],"responses":{"200":{"description":"Provider ratings retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"provider_id":{"type":"integer","example":456},"average_rating":{"type":"number","format":"float","example":4.3},"total_ratings":{"type":"integer","example":27},"ratings":{"type":"array","items":{"allOf":[{"$ref":"#/components/schemas/Rating"},{"type":"object","properties":{"customer_name":{"type":"string","example":"John D.","description":"Customer name (anonymized)"}}}]}}}}}}}}}},"/api/appointments/{appointmentId}/ratings":{"post":{"tags":["Ratings"],"summary":"Submit rating for appointment (Alternative endpoint)","description":"Submit a rating for a completed appointment","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["rating_value","rater_type"],"properties":{"rating_value":{"type":"integer","minimum":1,"maximum":5,"example":4,"description":"Rating value (1-5 stars)"},"rating_comment":{"type":"string","example":"Excellent service quality"},"rater_type":{"type":"string","enum":["customer","provider"],"example":"customer","description":"Who is submitting the rating"}}}}}},"responses":{"201":{"description":"Rating submitted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","examples":{"not_completed":{"value":"Can only rate completed appointments"},"already_rated":{"value":"Rating already submitted for this appointment"},"invalid_rating":{"value":"Rating value must be between 1 and 5"}}}}}}}}}},"get":{"tags":["Ratings"],"summary":"Get appointment ratings","description":"Get all ratings for a specific appointment","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"}],"responses":{"200":{"description":"Appointment ratings retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"ratings":{"type":"array","items":{"allOf":[{"$ref":"#/components/schemas/Rating"},{"type":"object","properties":{"user":{"type":"object","properties":{"first_name":{"type":"string"},"last_name":{"type":"string"},"profile_photo":{"type":"string","nullable":true}}},"serviceProvider":{"type":"object","properties":{"provider_first_name":{"type":"string"},"provider_last_name":{"type":"string"},"provider_profile_photo":{"type":"string","nullable":true}}}}}]}}}}}}}}}},"/api/appointments/{appointmentId}/can-rate":{"get":{"tags":["Ratings"],"summary":"Check if user can rate appointment","description":"Check if the authenticated user can rate a specific appointment","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"appointmentId","required":true,"schema":{"type":"integer"},"description":"Appointment ID"},{"in":"query","name":"rater_type","required":true,"schema":{"type":"string","enum":["customer","provider"]},"description":"Type of rater checking eligibility"}],"responses":{"200":{"description":"Rating eligibility check successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"can_rate":{"type":"boolean","example":true,"description":"Whether the user can rate this appointment"},"reason":{"type":"string","nullable":true,"example":null,"description":"Reason if cannot rate (e.g., \"Appointment not completed\", \"Rating already submitted\")"}}}}}},"404":{"description":"Appointment not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/services/categories":{"get":{"tags":["Services"],"summary":"Get service categories (Public)","description":"Get all available service categories","responses":{"200":{"description":"Service categories retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"category_id":{"type":"integer","example":1},"category_name":{"type":"string","example":"Plumbing"}}}}}}}}}},"/api/services/services":{"get":{"tags":["Services"],"summary":"Get provider services","description":"Get all services for the authenticated provider with enhanced data","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Provider services retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"type":"object","properties":{"listing_id":{"type":"integer","example":123},"service_id":{"type":"integer","example":123},"service_name":{"type":"string","example":"Kitchen Plumbing Repair"},"service_title":{"type":"string","example":"Kitchen Plumbing Repair"},"description":{"type":"string","example":"Professional kitchen plumbing repair services"},"service_description":{"type":"string","example":"Professional kitchen plumbing repair services"},"service_picture":{"type":"string","nullable":true,"example":"/uploads/service-images/service-123.jpg","description":"Validated path or null for fallback"},"price":{"type":"number","format":"float","example":150},"service_startingprice":{"type":"number","format":"float","example":150},"price_per_hour":{"type":"number","format":"float","example":150},"provider_id":{"type":"integer","example":456},"is_available":{"type":"boolean","example":true,"description":"Based on servicelisting_isActive"},"status":{"type":"string","enum":["active","inactive"],"example":"active"},"specific_services":{"type":"array","items":{"type":"object"}},"category_name":{"type":"string","example":"Plumbing","description":"From related category or \"Uncategorized\""},"category":{"type":"object","nullable":true},"category_id":{"type":"integer","nullable":true,"example":1},"certificates":{"type":"array","items":{"$ref":"#/components/schemas/Certificate"},"description":"Certificates covering the service"},"booking_count":{"type":"integer","example":0,"description":"Default value (not tracked in current schema)"}}}},"count":{"type":"integer","example":5,"description":"Total number of services"}}}}}},"401":{"description":"Unauthorized - Provider authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"tags":["Services"],"summary":"Create new service","description":"Create a new service listing for the authenticated provider","security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["service_title","service_description","service_startingprice","category_id"],"properties":{"service_title":{"type":"string","example":"Bathroom Renovation","description":"Title of the service"},"service_description":{"type":"string","example":"Complete bathroom renovation including plumbing and tiling","description":"Detailed description of the service"},"service_startingprice":{"type":"number","format":"float","example":500,"description":"Starting price for the service"},"category_id":{"type":"integer","example":1,"description":"Service category ID"},"service_picture":{"type":"string","format":"binary","description":"Service image (JPG, PNG - processed by middleware)"}}}}}},"responses":{"201":{"description":"Service created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/services/services/{serviceId}":{"get":{"tags":["Services"],"summary":"Get service by ID","description":"Get a specific service by ID for the authenticated provider","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"serviceId","required":true,"schema":{"type":"integer"},"description":"Service ID"}],"responses":{"200":{"description":"Service retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServiceListing"}}}},"404":{"description":"Service not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"put":{"tags":["Services"],"summary":"Update service","description":"Update an existing service for the authenticated provider","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"serviceId","required":true,"schema":{"type":"integer"},"description":"Service ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"service_title":{"type":"string","example":"Updated Service Title"},"service_description":{"type":"string","example":"Updated service description"},"service_startingprice":{"type":"number","format":"float","example":200},"servicelisting_isActive":{"type":"boolean","example":true,"description":"Service availability status"}}}}}},"responses":{"200":{"description":"Service updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse"}}}},"404":{"description":"Service not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"delete":{"tags":["Services"],"summary":"Delete service","description":"Delete a service for the authenticated provider","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"serviceId","required":true,"schema":{"type":"integer"},"description":"Service ID"}],"responses":{"200":{"description":"Service deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Service deleted successfully"}}}}}},"404":{"description":"Service not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/services/services/{serviceId}/toggle":{"patch":{"tags":["Services"],"summary":"Toggle service availability","description":"Toggle the servicelisting_isActive status of a service","security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"serviceId","required":true,"schema":{"type":"integer"},"description":"Service ID"}],"responses":{"200":{"description":"Service availability toggled successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Service availability updated"},"data":{"type":"object","properties":{"service_id":{"type":"integer","example":123},"servicelisting_isActive":{"type":"boolean","example":false}}}}}}}},"404":{"description":"Service not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/services/certificate-services":{"get":{"tags":["Services"],"summary":"Get certificate services (Public)","description":"Get services that are covered by certificates","responses":{"200":{"description":"Certificate services retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"certificate_id":{"type":"integer"},"certificate_name":{"type":"string"},"services":{"type":"array","items":{"type":"object","properties":{"specific_service_id":{"type":"integer"},"specific_service_title":{"type":"string"}}}}}}}}}}}}},"/api/services/certificates":{"get":{"tags":["Services"],"summary":"Get provider certificates","description":"Get all certificates for the authenticated provider","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Provider certificates retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Certificate"}}}}},"401":{"description":"Unauthorized - Provider authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}}}}